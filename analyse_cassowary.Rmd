---
title: "Cassowary"
output: html_document
---

### main question : Which factors influence the southern cassowary abundance?

Valeurs très élevées par rapport aux densités naturelles (≤3/km²)
Lorsque l'on a par exemple 100, 200 ou encore 500 casoars : ce n'est pas un comptage réel de ces casoars au km^2, mais des casoars vus plusieurs fois par plusieurs personnes au même endroit (ça peut être le même individu ou un différent, âges différents : pas de marquage-recapture)

```{r}
library(ggplot2)
library(corrplot)
```

```{r}
data_cassowary <- read.table("data_cassowary.txt", h = T)
summary(data_cassowary)
View(data_cassowary)
str(data_cassowary)
```


```{r}
#vérification des valeurs NA
colSums(is.na(data_cassowary))
```
No NA values on the dataset

#Etude de la variable $Y$ Sightings et distribution des valeurs de $Y$ (Sightings)

```{r}
summary(data_cassowary$Sightings)
table(data_cassowary$Sightings) #apparition de chaque valeur dans Sightings
prop.table(table(data_cassowary$Sightings)) * 100 #proportion de chaque valeur dans le dataset pour Sightings
```
a lot of zeros : 65% of the dataset

```{r}
par(mfrow=c(2,2))
# Boxplot
boxplot(data_cassowary$Sightings,col='dodgerblue3',ylab='Visual contact of cassowary')
# Cleveland plot
dotchart(data_cassowary$Sightings,pch=16,col='dodgerblue3',xlab='Visual contact of cassowary')
# Histogram
hist(data_cassowary$Sightings, breaks=10, col='dodgerblue3',xlab="Visual contact of cassowary",main="Comptages")

#Garder les 0, préférer un modèle binomial négatif

```
Several outliers
Hypotheses : 
- plusieurs casoars comptés en rapproché, surcomptages et doublons à certains endroits où le ou les casoars présents sont montrés plusieurs fois 

#borner/écrétage ?
```{r}
data_cassowary$Sightings <- pmin(data_cassowary$Sightings, 100) #bornage à 100
table(data_cassowary$Sightings)
summary(data_cassowary$Sightings)
```

#étude de Y mortalité sans tranformation

```{r}
#Mortalité
# Cleveland plot
dotchart(data_cassowary$Strikes,pch=16,col='dodgerblue3',xlab='Mortalité')
# Histogram
hist(data_cassowary$Strikes,col='dodgerblue3',xlab="Mortalité",main="")
# Quantile-Quantile plot
qqnorm(data_cassowary$Strikes,pch=16,col='dodgerblue3',xlab='')
qqline(data_cassowary$Strikes,col='red',lwd=2)
```
1 outlier à 12 et beaucoup de zéros : possible autocorrélation spatiale et aussi possible que le 12 soit lié à un biais observateir

#Etude des variables explicatives

quantitatif : 

Rainforest.P : proportion de forêts tropicales dans le patch #plutôt lié à Sightings
Residential.P : proportion d'aire résidentielle dans le patch #plutôt lié à Sightings
Fruit.P : proportion de cultures de fruits dans le patch  #plutôt lié à Sightings
Other.P : proportion de pâture dans le patch #plutôt lié à Sightings

Total_Road : longueur de la route dans le patch #plutôt lié à mortalité
Dresid : distance of the road to residential area #pluôt lié à mortalité
Dfruit : distance of the road to fruit crop area #plutôt lié à mortalité 

qualitatif : 
Residential.01 : presence/absence of residential area  #plutôt lié à Sightings
Fruit.01 : presence/absence of fruit crop  #plutôt lié à Sightings


### Distribution de valeurs de X quantitatives

```{r}
par(mfrow=c(2,3))

#Rainforest.P 
# Cleveland plot
dotchart(data_cassowary$Rainforest.P,pch=16,col='dodgerblue3',xlab="Proportion de rain forest")
# Histogram
hist(data_cassowary$Rainforest.P,col='dodgerblue3',xlab="Proportion de rain forest",main="")
# Quantile-Quantile plot
qqnorm(data_cassowary$Rainforest.P,pch=16,col='dodgerblue3',xlab='')
qqline(data_cassowary$Rainforest.P,col='red',lwd=2)

#Residential.P 
# Cleveland plot
dotchart(data_cassowary$Residential.P,pch=16,col='dodgerblue3',xlab="Proportion d'aire résidentielle")
# Histogram
hist(data_cassowary$Residential.P,col='dodgerblue3',xlab="Proportion d'aire résidentielle",main="")
# Quantile-Quantile plot
qqnorm(data_cassowary$Residential.P,pch=16,col='dodgerblue3',xlab='')
qqline(data_cassowary$Residential.P,col='red',lwd=2)

#Fruit.P 
# Cleveland plot
dotchart(data_cassowary$Fruit.P,pch=16,col='dodgerblue3',xlab="Proportion de cultures de fruits")
# Histogram
hist(data_cassowary$Fruit.P,col='dodgerblue3',xlab="Proportion de cultures de fruits",main="")
# Quantile-Quantile plot
qqnorm(data_cassowary$Fruit.P,pch=16,col='dodgerblue3',xlab='')
qqline(data_cassowary$Fruit.P,col='red',lwd=2)

#Other.P : proportion de pâture dans le patch
# Cleveland plot
dotchart(data_cassowary$Other.P,pch=16,col='dodgerblue3',xlab="Proportion de pâtures")
# Histogram
hist(data_cassowary$Other.P,col='dodgerblue3',xlab="Proportion de pâtures",main="")
# Quantile-Quantile plot
qqnorm(data_cassowary$Other.P,pch=16,col='dodgerblue3',xlab='')
qqline(data_cassowary$Other.P,col='red',lwd=2)

#Total_Road : longueur de la route
# Cleveland plot
dotchart(data_cassowary$Total_Road,pch=16,col='dodgerblue3',xlab="Longueur de la route")
# Histogram
hist(data_cassowary$Total_Road,col='dodgerblue3',xlab="Longueur de la route",main="")
# Quantile-Quantile plot
qqnorm(data_cassowary$Total_Road,pch=16,col='dodgerblue3',xlab='')
qqline(data_cassowary$Total_Road,col='red',lwd=2)

#Dresid : distance of the road to residential area
# Cleveland plot
dotchart(data_cassowary$Dresid,pch=16,col='dodgerblue3',xlab="Dresid")
# Histogram
hist(data_cassowary$Dresid,col='dodgerblue3',xlab="Dresid",main="")
# Quantile-Quantile plot
qqnorm(data_cassowary$Dresid,pch=16,col='dodgerblue3',xlab='')
qqline(data_cassowary$Dresid,col='red',lwd=2)

#Dfruit : distance of the road to fruit crop area
# Cleveland plot
dotchart(data_cassowary$Dfruit,pch=16,col='dodgerblue3',xlab="Dfruit")
# Histogram
hist(data_cassowary$Dfruit,col='dodgerblue3',xlab="Dfruit",main="")
# Quantile-Quantile plot
qqnorm(data_cassowary$Dfruit,pch=16,col='dodgerblue3',xlab='')
qqline(data_cassowary$Dfruit,col='red',lwd=2)

```


### X qualitatives : modalités et individus par modalité

```{r}

#remplacer valeurs 0 et 1 par présence/absence de RA et présence/abs F ?

#Residential.01 : presence/absence of residential area
data_cassowary$Residential.01 <- as.factor(data_cassowary$Residential.01)
summary(data_cassowary$Residential.01)

#Fruit.01 : presence/absence of fruit crop
data_cassowary$Fruit.01 <- as.factor(data_cassowary$Fruit.01)
summary(data_cassowary$Fruit.01)
```

### Analyser la relation potentielle entre Y et les X : pour Sightings et mortalité

#relation entre Sightings (borné) et variables potentiellement influentes
```{r}

par(mfrow=c(3,2)) 
# Rainforest.P
plot(data_cassowary$Sightings~data_cassowary$Rainforest.P,pch=16,col='olivedrab4',xlab='Proportion de Rainforest',ylab='Observations de Casoar')

#Residential.P
plot(data_cassowary$Sightings~data_cassowary$Residential.P,pch=16,col='olivedrab4',xlab='Proportion de résidence',ylab='Observations de Casoar')

# Fruit.P
plot(data_cassowary$Sightings~data_cassowary$Fruit.P,pch=16,col='olivedrab4',xlab='Proportion de cultures fruitères',ylab='Observations de Casoar')

#Other.P
plot(data_cassowary$Sightings~data_cassowary$Other.P,pch=16,col='olivedrab4',xlab='Proportion de pâtures',ylab='Observations de Casoar')

#Residential.01 : presence/absence of residential area 
boxplot(data_cassowary$Sightings~data_cassowary$Residential.01,pch=16,col='olivedrab4')

#Fruit.01 : presence/absence of fruit crop
boxplot(data_cassowary$Sightings~data_cassowary$Fruit.01,pch=16,col='olivedrab4')

```

+ de casoars quand la proportion de quartier résidentiel est moindre.
Mais + de casoars quand présence de fruits 
difficile de voir des tendance car les relations sont pas linéaires et beaucoup de 0.

Beaucoup de ZERO observations quand la proportion de forêt est moindre.

#relation entre mortalité et variables potentiellement influentes (longueur de route, distance aux cultures et quartier résidentiel)
```{r}
par(mfrow=c(1,3)) 

#Total_Road
plot(data_cassowary$Strikes~data_cassowary$Total_Road,pch=16,col='olivedrab4',xlab='Longueur de route',ylab='Strikes')

#Dresid 
plot(data_cassowary$Strikes~data_cassowary$Dresid,pch=16,col='olivedrab4',xlab='Distance de la route au quartier résidentiel',ylab='Strikes')

#Dfruit
plot(data_cassowary$Strikes~data_cassowary$Dfruit,pch=16,col='olivedrab4',xlab='Distance de la route aux cultures fruitières',ylab='Strikes')
```
Quand on regarde la distance par rapport aux cultures fruitières : plus la route en est proche plus il y a l'air d'y avoir de strikes/accidents.
La longueur de la route n'a pas l'air d'avoir bcp d'influence.

### Relation entre les X

```{r data_collinearity, echo=FALSE, results='markup'}

# Checking collinearity between continuous independent variables
plot(data_cassowary[,c(4,5,6,7,8,13,14,9,10)],pch=16,col='darkolivegreen4')   #9 et 10 ajoutés piur voir si corrélation avec Sightings et Strikes

M<-cor(data_cassowary[,c(4,5,6,7,8,13,14,9,10)])
corrplot.mixed(M,upper="square",lower.col="black", tl.col="black",cl.cex = 0.8,tl.cex = 0.7,number.cex =0.8)


```
Corrélation négative forte entre proportion de rainforest et proportion de pâture : Rainforest.P et Other.P 
Peut être plus judicieux de garder Rainforest.P et aussi + représentatif ?

Possible relation entre Sightings et les différentes bariables associées à la propotion 

Strikes et Sightings fortement corrélés : possible que les strikes dépendent de la densité de casoars.

DFruit et Fruit.P négativement corrélés mais logique : la proportions de cultures fruitières est plius faible lorsque l'on s'éloigne de ces cultures et que la distance entre route et cultures (Dfruit) est plus importante

```{r}
# Checking collinearity between categorical and continuous independent variables

par(mfrow=c(2,3))

# Rainforest.P et Fruit.01
boxplot(data_cassowary$Rainforest.P~data_cassowary$Fruit.01,varwidth = TRUE, ylab = "Proportion de Rainforest", xlab = "Présence ou absence de culture fruitière", col='grey', main = "")

#Residential.P et Fruit.01
boxplot(data_cassowary$Residential.P~data_cassowary$Fruit.01,varwidth = TRUE, ylab = "Proportion de Résidence", xlab = "Présence ou absence de culture fruitière", col='grey', main = "")

#Fruit.P et Fruit.01
boxplot(data_cassowary$Fruit.P~data_cassowary$Fruit.01,varwidth = TRUE, ylab = "Proportion de cultures fruitières", xlab = "Présence ou absence de culture fruitière", col='grey', main = "")


# Rainforest.P et Residential.01
boxplot(data_cassowary$Rainforest.P~data_cassowary$Residential.01,varwidth = TRUE, ylab = "Proportion de Rainforest", xlab = "Présence ou absence d'aire résidentielle", col='brown', main = "")

#Residential.P et Residential.01
boxplot(data_cassowary$Residential.P~data_cassowary$Residential.01,varwidth = TRUE, ylab = "Proportion de Résidence", xlab = "Présence ou absence d'aire résidentielle", col='brown', main = "")

#Fruit.P et Residential.01
boxplot(data_cassowary$Fruit.P~data_cassowary$Residential.01,varwidth = TRUE, ylab = "Proportion de cultures fruitières", xlab = "Présence ou absence d'aire résidentielle", col='brown', main = "")

```
Forcément : proportion de cultures fruitières corrélées à la présence ou absence de fruits, idem pour aire résidentielle

#Interactions potentielles entre les variables (en cours)







